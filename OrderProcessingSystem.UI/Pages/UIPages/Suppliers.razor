@page "/suppliers"
@using OrderProcessingSystem.UI.Shared.UIViewModels
@inject OrderProcessingSystem.Contracts.Interfaces.IViewModelDataProvider ViewModelDataProvider
@inject Microsoft.JSInterop.IJSRuntime JSRuntime
@inherits BaseDataPage<SupplierWithOrdersVM>
<link rel="stylesheet" href="~/css/suppliers.css" />

<BaseDataPage TItem="SupplierWithOrdersVM" 
              PageTitle="Suppliers"
              EntityName="suppliers"
              ShowCardsText="Show Cards"
              ShowGridText="All Suppliers"
              GridPageSize="10"
              CardPageSize="12"
              CardColumnClass="col-12 col-sm-6 col-md-4 col-xl-3 mb-3"
              DataLoader="@LoadSuppliersAsync">
    <CardTemplate Context="supplier">
        <div class="card p-3 card-content">
            <h5 class="text-truncate">@supplier.Name</h5>
            <p class="small text-muted">Country: @supplier.Country</p>
            <p class="small">Orders Supplied: <strong>@supplier.OrdersSupplied</strong></p>
        </div>
    </CardTemplate>
</BaseDataPage>

@code {
    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
    }

    // Data loader function for suppliers - now uses centralized ViewModelDataProvider
    private async Task<List<SupplierWithOrdersVM>?> LoadSuppliersAsync()
    {
        return await ViewModelDataProvider.GetSuppliersWithOrdersAsync<SupplierWithOrdersVM>();
    }
}
