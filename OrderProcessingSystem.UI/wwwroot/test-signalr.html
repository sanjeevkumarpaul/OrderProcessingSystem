<!DOCTYPE html>
<html>
<head>
    <title>SignalR Test</title>
</head>
<body>
    <h1>SignalR Loading Test</h1>
    <div id="output"></div>
    <button onclick="testAgain()">Test Again</button>
    
    <script src="/js/signalr.min.js"></script>
    <script>
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        function testSignalR() {
            log('=== SignalR Test Started ===');
            log('Starting SignalR test...');
            log('typeof signalR: ' + typeof signalR);
            
            if (typeof signalR !== 'undefined') {
                log('✅ SignalR library loaded successfully!');
                log('SignalR version: ' + (signalR.VERSION || 'unknown'));
                
                try {
                    const connection = new signalR.HubConnectionBuilder()
                        .withUrl("http://localhost:5269/userLogHub")
                        .build();
                        
                    log('✅ Connection object created successfully!');
                    
                    connection.start()
                        .then(() => {
                            log('✅ Connected to SignalR hub!');
                            return connection.invoke("JoinUserActivityGroup");
                        })
                        .then(() => {
                            log('✅ Joined UserActivityMonitors group!');
                            log('✅ SignalR is fully working!');
                        })
                        .catch(err => {
                            log('❌ Connection error: ' + err.toString());
                        });
                        
                } catch (ex) {
                    log('❌ Exception creating connection: ' + ex.toString());
                }
            } else {
                log('❌ SignalR library not loaded!');
                log('Check the network tab to see if signalr.min.js is loading');
            }
        }
        
        function testAgain() {
            document.getElementById('output').innerHTML = '';
            testSignalR();
        }
        
        // Test when DOM is loaded
        document.addEventListener('DOMContentLoaded', testSignalR);
        
        // Test immediately (in case DOM is already loaded)
        if (document.readyState === 'loading') {
            // Still loading
        } else {
            testSignalR();
        }
    </script>
</body>
</html>
    <script>
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }
        
        log('Starting SignalR test...');
        log('typeof signalR: ' + typeof signalR);
        
        if (typeof signalR !== 'undefined') {
            log('✅ SignalR library loaded successfully!');
            log('SignalR version: ' + (signalR.VERSION || 'unknown'));
            
            try {
                const connection = new signalR.HubConnectionBuilder()
                    .withUrl("http://localhost:5269/userLogHub")
                    .build();
                    
                log('✅ Connection object created successfully!');
                
                connection.start()
                    .then(() => {
                        log('✅ Connected to SignalR hub!');
                        return connection.invoke("JoinUserActivityGroup");
                    })
                    .then(() => {
                        log('✅ Joined UserActivityMonitors group!');
                    })
                    .catch(err => {
                        log('❌ Connection error: ' + err.toString());
                    });
                    
            } catch (ex) {
                log('❌ Exception creating connection: ' + ex.toString());
            }
        } else {
            log('❌ SignalR library not loaded!');
        }
    </script>
</body>
</html>
